name: Deploy
on:
  push:
    branches: [ main, master ]
jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
      - name: Debug
        run: echo $BUILD_CONFIGURATION


  build-and-push:
    runs-on: ubuntu-latest
    needs: debug
    steps:
      - uses: actions/checkout@v3
      - name: Buildah Build
        uses: redhat-actions/buildah-build@v2
        with:
          image: ${{ variables.QUAY_REGISTRY }}/alpine
          tags: latest
          containerfiles: |
            ./Dockerfile
      - name: Push To quay.io
        uses: redhat-actions/push-to-registry@v2
        with:
          image: ${{ variables.QUAY_REGISTRY }}/alpine
          tags: latest
          registry: ${{ variables.QUAY_REGISTRY }} #quay.io/net-sec
          username: ${{ variables.QUAY_REGISTRY_USER }} #claudio_walser
          password: ${{ secrets.QUAY_REGISTRY_PASSWORD }}
